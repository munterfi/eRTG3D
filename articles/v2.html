<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Standard workflow • eRTG3D</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Standard workflow">
<meta property="og:description" content="eRTG3D">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eRTG3D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v1.html">Example data</a>
    </li>
    <li>
      <a href="../articles/v2.html">Standard workflow</a>
    </li>
    <li>
      <a href="../articles/v3.html">Visualization of trajectories</a>
    </li>
    <li>
      <a href="../articles/v4.html">Verification of results</a>
    </li>
    <li>
      <a href="../articles/v5.html">Parallel computation</a>
    </li>
    <li>
      <a href="../articles/v6.html">Coordinate reference system</a>
    </li>
    <li>
      <a href="../articles/v7.html">Linkage to the sf package</a>
    </li>
    <li>
      <a href="../articles/v8.html">Trajectory simulations in 2-D</a>
    </li>
    <li>
      <a href="../articles/v9.html">Point cloud analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mufi.shinyapps.io/ertg3d-simulator">Simulator</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/munterfinger/eRTG3D">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/munterfi1">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://munterfinger.ch">
    <span class="fa fa-globe fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v2_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Standard workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/munterfinger/eRTG3D/blob/master/vignettes/v2.Rmd"><code>vignettes/v2.Rmd</code></a></small>
      <div class="hidden name"><code>v2.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<p>This vignette illustrates the basic functionality of the <code>eRTG3D</code> package and some workflows, to combine the functions in a meaningful way. For a more detailed description of the individual functions and their parameters please consider the package’s help.</p>
<div id="workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h2>
<div id="movement-characteristics-p" class="section level3">
<h3 class="hasAnchor">
<a href="#movement-characteristics-p" class="anchor"></a>1. Movement characteristics (P)</h3>
<p>As first step the properties of a track with x, y and z coordinates are calculated.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw">niclas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/track.properties.3d.html">track.properties.3d</a></span>(<span class="kw">niclas</span>)
</pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="13%">
<col width="9%">
<col width="11%">
<col width="9%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center">x</th>
<th align="center">y</th>
<th align="center">z</th>
<th align="center">a</th>
<th align="center">g</th>
<th align="center">t</th>
<th align="center">l</th>
<th align="center">d</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2556476</td>
<td align="center">1188336</td>
<td align="center">1284</td>
<td align="center">0.39</td>
<td align="center">1.56</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">2558565</td>
<td align="center">1189297</td>
<td align="center">1360</td>
<td align="center">0.43</td>
<td align="center">1.54</td>
<td align="center">0.04</td>
<td align="center">-0.02</td>
<td align="center">2301</td>
</tr>
<tr class="odd">
<td align="center">2560477</td>
<td align="center">1189861</td>
<td align="center">1370</td>
<td align="center">0.29</td>
<td align="center">1.57</td>
<td align="center">-0.14</td>
<td align="center">0.03</td>
<td align="center">1993</td>
</tr>
<tr class="even">
<td align="center">2562431</td>
<td align="center">1190668</td>
<td align="center">1392</td>
<td align="center">0.39</td>
<td align="center">1.56</td>
<td align="center">0.11</td>
<td align="center">-0.01</td>
<td align="center">2114</td>
</tr>
<tr class="odd">
<td align="center">2563809</td>
<td align="center">1190657</td>
<td align="center">1807</td>
<td align="center">-0.01</td>
<td align="center">1.28</td>
<td align="center">-0.4</td>
<td align="center">-0.28</td>
<td align="center">1439</td>
</tr>
</tbody>
</table>
<p>Then the movement characteristics (P probability) are extracted from the trajectory. Although the algorithm also works without a DEM, the DEM should be passed to the <code><a href="../reference/get.track.densities.3d.html">get.track.densities.3d()</a></code> function, otherwise the flight height distribution in respect to the earth surface can not be built, which ends in less accurate results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.track.densities.3d.html">get.track.densities.3d</a></span>(<span class="kw">niclas</span>, heightDistEllipsoid = <span class="fl">TRUE</span>, DEM = <span class="kw">dem</span>)
</pre></div>
</div>
<div id="attraction-term-q" class="section level3">
<h3 class="hasAnchor">
<a href="#attraction-term-q" class="anchor"></a>2. Attraction term (Q)</h3>
<p>The finally desired Conditional Empirical Random Walk (CERW) connecting a given start with a certain end point by a given number of steps needs an attraction term (the Q probability) to ensure that the target is approached and hit. In order to calculate the Q probability for each step the distribution of turns and lifts to target and the distribution of distance to target has to be known. They can be derived from the empirical data (ideally), or estimated from an unconditional process with the same properties. In this case the Q probabilities, which represent the pull towards the destination, are extracted from a UERW simulated with <code><a href="../reference/sim.uncond.3d.html">sim.uncond.3d()</a></code>. The UERW should contain 1500 <code>f &lt;- 1500</code> times more steps than the final CERW to be simulated. Q are extracted from the UERW by the function <code><a href="../reference/qProb.3d.html">qProb.3d()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">sim.locs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">niclas</span>)
<span class="kw">f</span> <span class="op">&lt;-</span> <span class="fl">1500</span>
<span class="kw">uerw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.uncond.3d.html">sim.uncond.3d</a></span>(<span class="kw">sim.locs</span><span class="op">*</span><span class="kw">f</span>, start = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">niclas</span><span class="op">$</span><span class="kw">x</span>[<span class="fl">1</span>], <span class="kw">niclas</span><span class="op">$</span><span class="kw">y</span>[<span class="fl">1</span>], <span class="kw">niclas</span><span class="op">$</span><span class="kw">z</span>[<span class="fl">1</span>]), 
                      a0 = <span class="kw">niclas</span><span class="op">$</span><span class="kw">a</span>[<span class="fl">1</span>], g0 = <span class="kw">niclas</span><span class="op">$</span><span class="kw">g</span>[<span class="fl">1</span>], densities = <span class="kw">P</span>)
<span class="kw">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qProb.3d.html">qProb.3d</a></span>(<span class="kw">uerw</span>, <span class="kw">sim.locs</span>)
</pre></div>
</div>
<div id="boundary-conditions" class="section level3">
<h3 class="hasAnchor">
<a href="#boundary-conditions" class="anchor"></a>3. Boundary conditions</h3>
<p>Set up the start and end conditions: azimuth (<code>a0</code>), gradient (<code>g0</code>), start and end point of the CERW to be simulated.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">niclas</span><span class="op">$</span><span class="kw">x</span>[<span class="fl">1</span>], <span class="kw">niclas</span><span class="op">$</span><span class="kw">y</span>[<span class="fl">1</span>], <span class="kw">niclas</span><span class="op">$</span><span class="kw">z</span>[<span class="fl">1</span>])
<span class="kw">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">niclas</span><span class="op">$</span><span class="kw">x</span>[<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">niclas</span>)], <span class="kw">niclas</span><span class="op">$</span><span class="kw">y</span>[<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">niclas</span>)], <span class="kw">niclas</span><span class="op">$</span><span class="kw">z</span>[<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">niclas</span>)])
<span class="kw">a0</span> <span class="op">&lt;-</span> <span class="kw">niclas</span><span class="op">$</span><span class="kw">a</span>[<span class="fl">1</span>]
<span class="kw">g0</span> <span class="op">&lt;-</span> <span class="kw">niclas</span><span class="op">$</span><span class="kw">g</span>[<span class="fl">1</span>]
</pre></div>
</div>
<div id="conditional-empirical-random-walk" class="section level3">
<h3 class="hasAnchor">
<a href="#conditional-empirical-random-walk" class="anchor"></a>4. Conditional Empirical Random Walk</h3>
<p>Then finally a CERW can be simulated.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">cerw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.cond.3d.html">sim.cond.3d</a></span>(<span class="kw">sim.locs</span>, start = <span class="kw">start</span>, end = <span class="kw">end</span>, a0 = <span class="kw">a0</span>, g0 = <span class="kw">g0</span>,
                    densities = <span class="kw">P</span>, qProbs = <span class="kw">Q</span>, DEM = <span class="kw">dem</span>)
</pre></div>
<p>If more than one simulated track is desired, the <code><a href="../reference/n.sim.cond.3d.html">n.sim.cond.3d()</a></code> can be used. The n.sim parameter defines the number of simulated tracks.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">cerwList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/n.sim.cond.3d.html">n.sim.cond.3d</a></span>(n.sim = <span class="fl">100</span>, <span class="kw">sim.locs</span>,
                          start = <span class="kw">start</span>, end = <span class="kw">end</span>, a0 = <span class="kw">a0</span>, g0 = <span class="kw">g0</span>,
                          densities = <span class="kw">P</span>, qProbs = <span class="kw">Q</span>, DEM = <span class="kw">dem</span>)
</pre></div>
<p><strong>Note:</strong> Due to dead ends, which are normally occurring in a proportion of 25%, the n.sim parameter should be set higher than the needed tracks.</p>
</div>
</div>
<div id="extract-densities-from-multiple-track-sections" class="section level2">
<h2 class="hasAnchor">
<a href="#extract-densities-from-multiple-track-sections" class="anchor"></a>Extract densities from multiple track sections</h2>
<p>In many cases the time between the acquisition of fix points of the GPS tracks is not constant. This can be caused by the time to get the fix point or missing data. To avoid distorted statistic distributions, which increases the probability of dead ends, the track has to be splitted in sections, where the acquisition time is constant. In this case the <code>get.track.properties.3d()</code> function can not be used anymore. Then the work flow should look like the following:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">trackSections</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/track.split.3d.html">track.split.3d</a></span>(<span class="kw">track</span>, <span class="kw">timeLag</span>)
<span class="kw">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.section.densities.3d.html">get.section.densities.3d</a></span>(<span class="kw">trackSections</span>, DEM = <span class="kw">dem</span>)
</pre></div>
<p><strong>Note:</strong> If the aim is to reproduce a track, then the length of the track should be adjusted to fit to the densities extracted by <code><a href="../reference/get.section.densities.3d.html">get.section.densities.3d()</a></code>. The message thrown by the previously applied <code><a href="../reference/track.split.3d.html">track.split.3d()</a></code> proposes a value <code>nChange</code> to adjust the track length of the simulations.</p>
</div>
<div id="wrapper-function-to-reproduce-tracks" class="section level2">
<h2 class="hasAnchor">
<a href="#wrapper-function-to-reproduce-tracks" class="anchor"></a>Wrapper function to reproduce tracks</h2>
<p>To reproduce an observed track, it is the simplest to just apply the <code><a href="../reference/reproduce.track.3d.html">reproduce.track.3d()</a></code> function on the track and the DEM. The function automatically wraps all steps above together. To produce multiple tracks, the <code>n.sim</code> variable can be used.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">cerwList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reproduce.track.3d.html">reproduce.track.3d</a></span>(n.sim = <span class="fl">100</span>, <span class="kw">niclas</span>, DEM = <span class="kw">dem</span>)
</pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Merlin Unterfinger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
